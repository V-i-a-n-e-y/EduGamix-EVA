<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduGamix - Bingo de Ecuaciones</title>
    <link rel="stylesheet" href="nivel1-juego1.css">
</head>
<body>
    <!-- Encabezado -->
    <header>
        <div class="logo">
            <a href="index.html" target="_blank">
                <img src="img/EduGamix.jpg" alt="EduGamix Logo" height="150">
            </a>
        </div>
        <h1>Nivel 1 - Bingo de Ecuaciones Lineales</h1>
        <div class="user-info">
            <span id="username">Usuario</span> | <span id="useremail">correo@ejemplo.com</span>
            <a class="logout-link" title="Cerrar sesi√≥n" onclick="logout()">Cerrar sesi√≥n</a>
        </div>
    </header>

    <!-- Contenedor principal -->
    <div class="game-container">
        <div class="challenge-info">
            <p>‚è≥ Tiempo: <span id="timer">00:00</span></p>
            <p>Puntos obtenidos: <span id="points">0</span></p>
            <p>Intentos restantes: <span id="attempts">3</span></p>
        </div>

        <!-- Ecuaciones -->
        <div class="equation-container">
            <h2>El sistema de ecuaciones es:</h2>
            <p id="equation">x + y = 5, 2x - y = 1</p>
            <button onclick="prevEquation()">‚¨Ö Regresar</button>
            <button onclick="nextEquation()">Siguiente ‚û°</button>
        </div>

        <!-- Bingo -->
        <div class="bingo-container">
            <h2>Bingo</h2>
            <input type="text" id="answer" placeholder="Escribe tu respuesta">
            <button onclick="verificarYMostrar()">Verificar</button>
            <button onclick="feliBingo()">¬°Bingo!</button>
            <button onclick="restartGame()">Reiniciar Juego</button>
        </div>
    </div>

    <!-- Modal de Felicitaci√≥n -->
    <div id="felicitacion-modal" class="modal">
        <div class="modal-content">
            <h2>üéâ Felicidades üéâ</h2>
            <p>¬°Has completado el desaf√≠o Explorando Soluciones Lineales!</p>
            <p>Puntaje final: <span id="final-score"></span></p>
            <img src="img/gami.jpg" alt="Gami" class="avatar-modal">
            <button id="restart-btn">Reiniciar Juego</button>
            <button onclick="window.location.href='modo-juego-n1.html';">Regresar</button>
        </div>
    </div>

    <!-- Modal de Retroalimentaci√≥n -->
    <div id="feedback-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeFeedback()">&times;</span>
            <h2>Retroalimentaci√≥n</h2>
            <table id="feedback-table">
                <thead>
                    <tr>
                        <th>Ecuaci√≥n</th>
                        <th>Soluci√≥n</th>
                        <th>Tu respuesta</th>
                    </tr>
                </thead>
                <tbody id="feedback-table-body"></tbody>
            </table>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // ‚úÖ Cargar datos del usuario
            const username = localStorage.getItem("username") || "Invitado";
            const useremail = localStorage.getItem("useremail") || "correo@ejemplo.com";
            document.getElementById("username").textContent = username;
            document.getElementById("useremail").textContent = useremail;

            // ‚úÖ Variables del juego
            let currentEquationIndex = 0;
            let puntos = 0;
            let intentos = 3;
            let ecuaciones = [
                { ecuacion: "x + y = 2, 2x + y = 5", solucion: "x = 3, y = -1", respuestaUsuario: "" },
                { ecuacion: "2x + 4y = 0, x + 2y = 4", solucion: "x = 2, y = -1", respuestaUsuario: "" },
                { ecuacion: "3x + 2y = 11, 4x + 5y = 7", solucion: "x = 3, y = 1", respuestaUsuario: "" },
                { ecuacion: "2x + 3y = -1, 3x + 4y = 0", solucion: "x = 4, y = -3", respuestaUsuario: "" },
                { ecuacion: "x + 2y = 5, 3x - 2y = 19", solucion: "x = 7, y = 1", respuestaUsuario: "" }
            ];

            // ‚úÖ Mostrar ecuaciones
            function mostrarEcuacion() {
                document.getElementById("equation").textContent = ecuaciones[currentEquationIndex].ecuacion;
            }

            function prevEquation() {
                if (currentEquationIndex > 0) {
                    currentEquationIndex--;
                    mostrarEcuacion();
                }
            }

            function nextEquation() {
                if (currentEquationIndex < ecuaciones.length - 1) {
                    currentEquationIndex++;
                    mostrarEcuacion();
                }
            }

            // ‚úÖ Verificar respuesta
            function verificarYMostrar() {
                const respuestaUsuario = document.getElementById("answer").value.trim();
                ecuaciones[currentEquationIndex].respuestaUsuario = respuestaUsuario;

                if (respuestaUsuario === ecuaciones[currentEquationIndex].solucion) {
                    puntos += 10;
                    document.getElementById("points").textContent = puntos;
                    alert("¬°Correcto!");
                } else {
                    intentos--;
                    document.getElementById("attempts").textContent = intentos;
                    alert(intentos > 0 ? "Incorrecto. Intenta de nuevo." : "Juego terminado. Se acabaron los intentos.");
                }

                showFeedbackModal();
            }

            // ‚úÖ Mostrar retroalimentaci√≥n
            function showFeedbackModal() {
                const modal = document.getElementById("feedback-modal");
                const feedbackTableBody = document.getElementById("feedback-table-body");
                feedbackTableBody.innerHTML = "";

                ecuaciones.forEach((item) => {
                    const row = document.createElement("tr");
                    row.innerHTML = `<td>${item.ecuacion}</td><td>${item.solucion}</td><td>${item.respuestaUsuario || "No respondida"}</td>`;
                    feedbackTableBody.appendChild(row);
                });

                modal.style.display = "block";
            }

            function closeFeedback() {
                document.getElementById("feedback-modal").style.display = "none";
            }

            // ‚úÖ Reiniciar juego
            function restartGame() {
                puntos = 0;
                intentos = 3;
                currentEquationIndex = 0;
                document.getElementById("points").textContent = puntos;
                document.getElementById("attempts").textContent = intentos;
                mostrarEcuacion();
            }

            // ‚úÖ Mostrar modal de felicitaci√≥n
            function feliBingo() {
                document.getElementById("final-score").textContent = puntos;
                document.getElementById("felicitacion-modal").style.display = "flex";
            }

            // ‚úÖ Evento para reiniciar desde el modal
            document.getElementById("restart-btn").addEventListener("click", function () {
                restartGame();
                document.getElementById("felicitacion-modal").style.display = "none";
            });

            // ‚úÖ Mostrar la primera ecuaci√≥n al iniciar
            mostrarEcuacion();
        });
    </script>
</body>
</html>
