<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EduGamix</title>
  <link rel="stylesheet" href="nivel 1 juego1.css" />
  <style>
    /* Estilos generales */
    body {
      font-family: Arial, sans-serif;
      text-align: center;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(4, 150px);
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }
    .card {
      width: 150px;
      height: 200px;
      background-color: #d99;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      position: relative;
    }
    .hidden {
      background-color: #555;
    }
    .card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: none;
    }
    .card.revealed img {
      display: block;
    }
    /* Estilos para los modales */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      position: relative;
      width: 80%;
      max-width: 400px;
    }
    .modal-content .close {
      position: absolute;
      top: 10px;
      right: 15px;
      cursor: pointer;
      font-size: 24px;
    }
    .modal-content:focus {
      color: #ffddc1;
      text-decoration: none;
      cursor: pointer;
    }
    /* Contenedor de botones en Memorama */
    .button-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    /* Animaci√≥n de aparici√≥n */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .avatar-feedback {
      position: fixed;
      bottom: 20px;
      right: 150px;
      width: 150px;
      height: 150px;
      transition: transform 0.5s ease;
      z-index: 1000;
      animation: fadeIn 1s ease forwards;
    }
    .avatar-feedback:hover {
      transform: scale(1.1);
    }
    .felicitacion-modal .close {
      float: right;
      font-size: 28px;
      cursor: pointer;
    }
    .felicitacion-modal:focus {
      color: #ffddc1;
      text-decoration: none;
      cursor: pointer;
    }
    .felicitacion-modal {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      width: 30%;
      margin: 15% auto;
      text-align: center;
      position: relative;
      z-index: 500;
    }
    /* Posiciona el avatar en el centro del modal */
    .avatar-modal {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 0 auto;
    }
    /* Contenedor de los botones para alinearlos abajo */
    .botones-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      width: 100%;
      margin-top: 20px;
    }
    .botones-container button {
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s ease;
    }
    .boton-salir {
      background: #d9534f;
      color: white;
    }
    .boton-reintentar {
      background: #5bc0de;
      color: white;
    }
    .botones-container button:hover {
      opacity: 0.8;
    }
  </style>
</head>
<body>
  <!-- Encabezado -->
  <header>
    <div class="logo">
      <a href="index.html" target="_blank">
        <img src="img/EduGamix.jpg" alt="EduGamix Logo" />
      </a>
    </div>
    <h1>Inicio</h1>
    <div class="user-info">
      <span class="icon" title="Notificaciones" onclick="alert('Notificaciones');">üîî</span>
      <span class="icon" title="Difusi√≥n" onclick="window.location.href='ini2.html';">üì¢</span>
      <span class="icon" title="Inicio" onclick="window.location.href='inicio.html';">üè†</span>
      <div class="user-info">
        <i class="fas fa-user-circle" style="font-size: 24px; margin-right: 8px;"></i>
        <span id="username">Nombre de Usuario</span> | 
        <span id="useremail">correo@ejemplo.com</span>
        <a class="logout-link" title="Cerrar sesi√≥n" onclick="logout()">Cerrar sesi√≥n</a>
      </div>
      <span class="icon" title="Perfil" onclick="window.location.href='miespacio.html';">üë§</span>
    </div>
  </header>

  <!-- Modal de Retroalimentaci√≥n (pista) -->
  <div id="retroalimentacion-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="cerrarRetroalimentacion()">&times;</span>
      <div class="retroalimentacion">
        <p>
          <strong>Pregunta 1:</strong> Este m√©todo recibe el nombre de un matem√°tico famoso y utiliza 
          determinantes para hallar cada inc√≥gnita, siempre que el determinante del sistema sea distinto de cero.
        </p>
      </div>
    </div>
  </div>

  <!-- Bot√≥n de retroalimentaci√≥n -->
  <img src="img/xilo-avatar.jpg" alt="Avatar" class="avatar-feedback" 
       onclick="mostrarRetroalimentacion()" 
       style="cursor: pointer;" 
       title="Da clic para tener una pista" />

  <!-- Secci√≥n de desaf√≠o (cuestionario) -->
  <div class="container">
    <!-- Temporizador -->
    <h2 id="question"></h2>
    <div id="options"></div>
    <p id="feedback"></p>
    
    <!-- Modal de Felicitaci√≥n (Feedback final) -->
    <div id="felicitacion-modal" class="modal">
      <div class="felicitacion-modal">
        <span class="close" onclick="cerrarFelicitacion()">&times;</span>
        <h2>üéâ ¬°Felicidades! üéâ</h2>
        <p>¬°Has completado el desaf√≠o Explorando Soluciones Lineales!</p>
        <p>Puntaje final: <span id="final-score"></span></p>
        <p>Tiempo total: <span id="final-time"></span></p>
        <img src="img/gami.jpg" alt="Gami" class="avatar-modal" />
        <button id="restart-btn">Reiniciar Juego</button>
        <button id="modo-btn" onclick="window.location.href='modo juego n3.html';">Regresar</button>
      </div>
    </div>
  </div>

  <!-- Secci√≥n del Memorama -->
  <main>
    <h2>Memorama de M√©todos de Soluci√≥n</h2>
    <p>Encuentra las parejas correctas de m√©todos y sus representaciones.</p>
    <p>TIEMPO: <span id="timer">05:00</span></p>
    <p id="score-memorama">Puntuaci√≥n: 0</p>
    <div class="grid" id="grid"></div>

    <!-- Contenedor de botones para el Memorama -->
    <div class="button-container">
      <button onclick="finalizarJuego(); reproducirSonidoBoton();">Fin del Juego</button>
      <button id="exit-memorama-btn" onclick="window.location.href='inicio.html';">Salir</button>
    </div>
  </main>

  <!-- JavaScript Consolidado -->
  <script>
    /* Funci√≥n para cerrar sesi√≥n */
    function logout() {
      localStorage.removeItem("username");
      localStorage.removeItem("useremail");
      window.location.href = "login.html";
    }

    /* Temporizador en cuenta regresiva desde 5 minutos */
    let seconds = 0, minutes = 5, timerInterval;
    let isGameOver = false;

    function startTimer() {
      timerInterval = setInterval(() => {
        if (!isGameOver) {
          // Si el tiempo se ha agotado, detenemos el juego
          if (minutes === 0 && seconds === 0) {
            isGameOver = true;
            stopTimer();
            // Si no se ha contestado nada, aseguramos que el puntaje sea 0
            if(scoreMemorama === 0) {
              scoreMemorama = 0;
            }
            finalizarJuego();
          } else {
            // L√≥gica de cuenta regresiva
            if (seconds === 0) {
              if (minutes > 0) {
                minutes--;
                seconds = 59;
              }
            } else {
              seconds--;
            }
          }
          // Actualizamos la visualizaci√≥n del temporizador
          document.getElementById("timer").innerText =
            (minutes < 10 ? "0" : "") + minutes + ":" + (seconds < 10 ? "0" : "") + seconds;
        }
      }, 1000);
    }

    // Funci√≥n para detener el temporizador y actualizar el tiempo final
    function stopTimer() {
      clearInterval(timerInterval);
      document.getElementById("final-time").innerText =
        (minutes < 10 ? "0" : "") + minutes + ":" + (seconds < 10 ? "0" : "") + seconds;
    }

    /* Modales: Felicitaci√≥n y Retroalimentaci√≥n */
    function mostrarFelicitacion() {
      isGameOver = true;
      stopTimer();
      document.getElementById("final-score").textContent = scoreMemorama;
      document.getElementById("felicitacion-modal").style.display = "flex";
    }

    function cerrarFelicitacion() {
      document.getElementById("felicitacion-modal").style.display = "none";
    }

    function mostrarRetroalimentacion() {
      document.getElementById("retroalimentacion-modal").style.display = "flex";
      const narrador = new SpeechSynthesisUtterance();
      narrador.text = `Pregunta: ¬øQu√© m√©todo se usa para resolver sistemas de ecuaciones lineales utilizando determinantes de matrices?
Pista: Este m√©todo recibe el nombre de un matem√°tico famoso y utiliza determinantes para hallar cada inc√≥gnita, siempre que el determinante del sistema sea distinto de cero.

Pregunta: ¬øCu√°l de los siguientes es un espacio vectorial?
Pista: Busca un conjunto que, junto con las operaciones de suma y multiplicaci√≥n por un escalar, cumple todos los axiomas necesarios para ser considerado un espacio vectorial. Piensa en un conjunto donde la estructura algebraica es especialmente flexible y se pueden definir polinomios de cualquier grado.

Pregunta: ¬øQu√© operaci√≥n es fundamental en la eliminaci√≥n de Gauss?
Pista: Durante este proceso, es habitual reordenar las filas para evitar divisiones por cero o para facilitar la transformaci√≥n del sistema en una forma escalonada. ¬øQu√© operaci√≥n permite cambiar el orden de las ecuaciones?

Pregunta: ¬øCu√°l es la dimensi√≥n del espacio vectorial R¬≥?
Pista: La dimensi√≥n de un espacio vectorial se corresponde con el n√∫mero de componentes que tiene cada vector en √©l. ¬øQu√© n√∫mero representa el ‚Äún‚Äù en R‚Åø cuando n = 3?

Pregunta: Si una matriz tiene un determinante igual a 0, ¬øqu√© significa?
Pista: Cuando el determinante de una matriz es cero, la matriz pierde la propiedad de tener una inversa. Se dice que posee una caracter√≠stica especial que la clasifica de cierta forma en el √°lgebra lineal.`;
      narrador.lang = 'es-ES';
      speechSynthesis.speak(narrador);
    }

    function cerrarRetroalimentacion() {
      document.getElementById("retroalimentacion-modal").style.display = "none";
      if (speechSynthesis.speaking) {
        speechSynthesis.cancel();
      }
    }

    /* Memorama */
    let scoreMemorama = localStorage.getItem("scoreMemorama") 
                           ? parseInt(localStorage.getItem("scoreMemorama")) 
                           : 0;
    const totalPairs = 4;
    let matchedPairs = 0;
    let selectedCards = [];

    const cards = [
      { image: "img/cramer.jpg", pair: 1 },
      { image: "img/regla de cramer.png", pair: 1 },
      { image: "img/gauss.png", pair: 2 },
      { image: "img/m gauss.jpg", pair: 2 },
      { image: "img/gauss jprdan.jpg", pair: 3 },
      { image: "img/g y j.png", pair: 3 },
      { image: "img/inversa.jpg", pair: 4 },
      { image: "img/m inversa.png", pair: 4 }
    ];

    let shuffledCards = [...cards].sort(() => Math.random() - 0.5);

    function createCard(card, index) {
      const div = document.createElement("div");
      div.classList.add("card", "hidden");
      div.dataset.pair = card.pair;
      div.dataset.index = index;

      const img = document.createElement("img");
      img.src = card.image;
      img.alt = `Imagen de m√©todo ${card.pair}`;

      div.appendChild(img);
      div.addEventListener("click", () => flipCard(div));
      return div;
    }

    function flipCard(card) {
      if (!card || selectedCards.length >= 2 || card.classList.contains("revealed")) return;
      card.classList.remove("hidden");
      card.classList.add("revealed");
      selectedCards.push(card);

      if (selectedCards.length === 2) {
        setTimeout(checkMatch, 1000);
      }
    }

    function checkMatch() {
      if (selectedCards.length === 2) {
        const [firstCard, secondCard] = selectedCards;
        if (firstCard.dataset.pair === secondCard.dataset.pair) {
          scoreMemorama += 10;
          matchedPairs++;
          document.getElementById("score-memorama").textContent = `Puntuaci√≥n: ${scoreMemorama}`;
          localStorage.setItem("scoreMemorama", scoreMemorama);
          selectedCards = [];
          if (matchedPairs === totalPairs) {
            finalizarJuego();
          }
        } else {
          setTimeout(() => {
            selectedCards.forEach(card => {
              card.classList.add("hidden");
              card.classList.remove("revealed");
            });
            selectedCards = [];
          }, 1000);
        }
      }
    }

    function reproducirSonidoTrompetas() {
      const audio = new Audio("img/trompetas.mp3");
      audio.play();
    }
    
    function reproducirSonidoBoton() {
      const audio = new Audio("sonidos/click.mp3");
      audio.play();
    }
    
    // Funci√≥n para mostrar el modal final (felicitaci√≥n)
    function feliBingo() {
      stopTimer();
      document.getElementById("felicitacion-modal").style.display = "flex";
      reproducirSonidoTrompetas();
    }
    
    function finalizarJuego() {
      // Si no se ha contestado nada, nos aseguramos que el puntaje sea 0
      if (scoreMemorama === 0) {
        scoreMemorama = 0;
      }
      localStorage.setItem("juegoFinalizado", "true");
      localStorage.setItem("puntaje", scoreMemorama);
      document.getElementById("final-score").textContent = scoreMemorama;
      feliBingo();
    }
    
    function iniciarJuego() {
      const grid = document.getElementById("grid");
      grid.innerHTML = "";
      shuffledCards.forEach((card, index) => {
        grid.appendChild(createCard(card, index));
      });
    }

    /* Inicializaci√≥n al cargar el DOM */
    document.addEventListener("DOMContentLoaded", function() {
      // Cargar datos de usuario
      const username = localStorage.getItem("username");
      const useremail = localStorage.getItem("useremail");
      if (username) document.getElementById("username").textContent = username;
      if (useremail) document.getElementById("useremail").textContent = useremail;
      
      // Iniciar temporizador y juego
      startTimer();
      localStorage.setItem("scoreMemorama", 0);
      iniciarJuego();
      
      // Reiniciar juego desde el modal de felicitaci√≥n
      document.getElementById("restart-btn").addEventListener("click", () => {
        isGameOver = false;
        seconds = 0;
        minutes = 3;
        document.getElementById("timer").innerText = "05:00";
        document.getElementById("felicitacion-modal").style.display = "none";
        location.reload();
      });
    });
  </script>
</body>
</html>
